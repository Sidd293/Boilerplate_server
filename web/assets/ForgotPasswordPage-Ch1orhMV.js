import{u as k,a as R,r as n,j as e,B as x,d as S,L as q}from"./index-46iyn6WS.js";import{d as A,e as M,i as C,c as E,I as u,p as g}from"./otp-DaDmepPU.js";import{u as j,A as y}from"./client-BXfVluCH.js";function O(){return j({mutationFn:A})}function B(){const m=k(t=>t.setAuth);return j({mutationFn:M,onSuccess:t=>{m(t.data.user,t.data.token)}})}function I(){const m=R(),t=O(),o=B(),[r,N]=n.useState(""),[l,b]=n.useState(""),[d,v]=n.useState(""),[i,h]=n.useState(!1),[c,P]=n.useState(!1),a=n.useMemo(()=>{const s={};return r.trim()||(s.identity="Email or phone is required."),c&&(l?C(l)||(s.code="Enter the 6-digit code."):s.code="OTP code is required.",d?E(d)||(s.newPassword="Password must be at least 8 characters."):s.newPassword="New password is required."),s},[r,l,d,c]),w=async()=>{if(h(!0),!r.trim())return;const s=g(r);if(s)try{await t.mutateAsync(s),P(!0)}catch{}},F=async s=>{if(s.preventDefault(),h(!0),Object.keys(a).length>0)return;const f=g(r);if(f)try{await o.mutateAsync({...f,code:l,newPassword:d}),m("/dashboard",{replace:!0})}catch{}},p=t.error instanceof y&&t.error.message||o.error instanceof y&&o.error.message||null;return e.jsxs("form",{onSubmit:F,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"identity",className:"text-sm font-medium text-slate-200",children:"Email or phone"}),e.jsx(u,{id:"identity",type:"text",name:"identity",placeholder:"you@company.com or +1 555 000 0000",value:r,onChange:s=>N(s.target.value),className:"mt-2 bg-white/90","aria-invalid":!!(i&&a.identity)}),i&&a.identity?e.jsx("p",{className:"mt-2 text-xs text-rose-300",children:a.identity}):null]}),c?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"code",className:"text-sm font-medium text-slate-200",children:"6-digit code"}),e.jsx(u,{id:"code",type:"text",name:"code",placeholder:"123456",value:l,onChange:s=>b(s.target.value),className:"mt-2 bg-white/90","aria-invalid":!!(i&&a.code)}),i&&a.code?e.jsx("p",{className:"mt-2 text-xs text-rose-300",children:a.code}):null]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"newPassword",className:"text-sm font-medium text-slate-200",children:"New password"}),e.jsx(u,{id:"newPassword",type:"password",name:"newPassword",placeholder:"Minimum 8 characters",value:d,onChange:s=>v(s.target.value),className:"mt-2 bg-white/90","aria-invalid":!!(i&&a.newPassword)}),i&&a.newPassword?e.jsx("p",{className:"mt-2 text-xs text-rose-300",children:a.newPassword}):null]})]}):e.jsx("div",{className:"text-xs text-white/60",children:"We’ll send a one-time code to verify your identity."}),p?e.jsx("div",{className:"rounded-2xl border border-rose-500/40 bg-rose-500/10 p-3 text-xs text-rose-200",children:p}):null,c?e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx(x,{type:"submit",className:"w-full",disabled:o.isPending,children:o.isPending?"Resetting…":"Reset password"}),e.jsx(x,{type:"button",variant:"ghost",className:"w-full text-white",onClick:w,disabled:t.isPending,children:t.isPending?"Resending…":"Resend code"})]}):e.jsx(x,{type:"button",className:"w-full",onClick:w,disabled:t.isPending,children:t.isPending?"Sending…":"Send reset code"})]})}function z(){return e.jsx("div",{className:"relative z-10 min-h-screen px-6 py-10 sm:px-10",children:e.jsxs("div",{className:"mx-auto grid w-full max-w-5xl gap-10 lg:grid-cols-[1.1fr,0.9fr]",children:[e.jsxs("section",{className:"hidden flex-col justify-between lg:flex",children:[e.jsx(S,{}),e.jsx("div",{className:"mt-20",children:e.jsxs("div",{className:"rounded-3xl border border-white/10 bg-white/5 p-8 shadow-2xl",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-emerald-200",children:"Reset securely"}),e.jsx("h2",{className:"mt-4 text-3xl font-semibold text-white",children:"Get back into your workspace quickly."}),e.jsx("p",{className:"mt-4 text-sm text-white/70",children:"We’ll send a secure link to verify your identity and reset your password."})]})}),e.jsx("p",{className:"text-xs text-white/40",children:"© 2026 Boilerplate. All rights reserved."})]}),e.jsx("section",{className:"flex flex-col justify-center",children:e.jsxs("div",{className:"mx-auto w-full max-w-md rounded-3xl border border-white/10 bg-white/5 p-8 shadow-2xl backdrop-blur",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-emerald-200",children:"Forgot your password"}),e.jsx("h1",{className:"text-3xl font-semibold text-white",children:"Reset access"}),e.jsx("p",{className:"text-sm text-white/60",children:"Enter the email linked to your account."})]}),e.jsx("div",{className:"mt-8",children:e.jsx(I,{})}),e.jsxs("div",{className:"mt-6 text-center text-xs text-white/60",children:["Remembered your password?"," ",e.jsx(q,{to:"/login",className:"font-semibold text-emerald-200",children:"Sign in"})]})]})})]})})}export{z as default};
