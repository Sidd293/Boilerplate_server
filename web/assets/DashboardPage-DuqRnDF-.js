import{S as se,p as V,f as p,s as U,g as b,n as D,i as A,h as $,t as re,k as N,l as ie,m as ae,o as G,q as Y,r as u,v as Z,w as ne,c as M,j as i,e as R,B as oe}from"./index-DA43bROf.js";import{a as ee,u as ce}from"./client-LD5mSrz_.js";var he=class extends se{constructor(e,t){super(),this.options=t,this.#s=e,this.#i=null,this.#r=V(),this.bindMethods(),this.setOptions(t)}#s;#e=void 0;#p=void 0;#t=void 0;#n;#l;#r;#i;#m;#u;#d;#o;#c;#a;#f=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#e.addObserver(this),J(this.#e,this.options)?this.#h():this.updateResult(),this.#v())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return F(this.#e,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return F(this.#e,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#b(),this.#R(),this.#e.removeObserver(this)}setOptions(e){const t=this.options,s=this.#e;if(this.options=this.#s.defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof p(this.options.enabled,this.#e)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#C(),this.#e.setOptions(this.options),t._defaulted&&!U(this.options,t)&&this.#s.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#e,observer:this});const r=this.hasListeners();r&&q(this.#e,s,this.options,t)&&this.#h(),this.updateResult(),r&&(this.#e!==s||p(this.options.enabled,this.#e)!==p(t.enabled,this.#e)||b(this.options.staleTime,this.#e)!==b(t.staleTime,this.#e))&&this.#x();const a=this.#g();r&&(this.#e!==s||p(this.options.enabled,this.#e)!==p(t.enabled,this.#e)||a!==this.#a)&&this.#y(a)}getOptimisticResult(e){const t=this.#s.getQueryCache().build(this.#s,e),s=this.createResult(t,e);return ue(this,s)&&(this.#t=s,this.#l=this.options,this.#n=this.#e.state),s}getCurrentResult(){return this.#t}trackResult(e,t){return new Proxy(e,{get:(s,r)=>(this.trackProp(r),t?.(r),r==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#r.status==="pending"&&this.#r.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(s,r))})}trackProp(e){this.#f.add(e)}getCurrentQuery(){return this.#e}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const t=this.#s.defaultQueryOptions(e),s=this.#s.getQueryCache().build(this.#s,t);return s.fetch().then(()=>this.createResult(s,t))}fetch(e){return this.#h({...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#t))}#h(e){this.#C();let t=this.#e.fetch(this.options,e);return e?.throwOnError||(t=t.catch(D)),t}#x(){this.#b();const e=b(this.options.staleTime,this.#e);if(A||this.#t.isStale||!$(e))return;const s=re(this.#t.dataUpdatedAt,e)+1;this.#o=N.setTimeout(()=>{this.#t.isStale||this.updateResult()},s)}#g(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#e):this.options.refetchInterval)??!1}#y(e){this.#R(),this.#a=e,!(A||p(this.options.enabled,this.#e)===!1||!$(this.#a)||this.#a===0)&&(this.#c=N.setInterval(()=>{(this.options.refetchIntervalInBackground||ie.isFocused())&&this.#h()},this.#a))}#v(){this.#x(),this.#y(this.#g())}#b(){this.#o&&(N.clearTimeout(this.#o),this.#o=void 0)}#R(){this.#c&&(N.clearInterval(this.#c),this.#c=void 0)}createResult(e,t){const s=this.#e,r=this.options,a=this.#t,d=this.#n,n=this.#l,g=e!==s?e.state:this.#p,{state:l}=e;let o={...l},y=!1,c;if(t._optimisticResults){const f=this.hasListeners(),v=!f&&J(e,t),S=f&&q(e,s,t,r);(v||S)&&(o={...o,...ae(l.data,e.options)}),t._optimisticResults==="isRestoring"&&(o.fetchStatus="idle")}let{error:C,errorUpdatedAt:H,status:x}=o;c=o.data;let B=!1;if(t.placeholderData!==void 0&&c===void 0&&x==="pending"){let f;a?.isPlaceholderData&&t.placeholderData===n?.placeholderData?(f=a.data,B=!0):f=typeof t.placeholderData=="function"?t.placeholderData(this.#d?.state.data,this.#d):t.placeholderData,f!==void 0&&(x="success",c=G(a?.data,f,t),y=!0)}if(t.select&&c!==void 0&&!B)if(a&&c===d?.data&&t.select===this.#m)c=this.#u;else try{this.#m=t.select,c=t.select(c),c=G(a?.data,c,t),this.#u=c,this.#i=null}catch(f){this.#i=f}this.#i&&(C=this.#i,c=this.#u,H=Date.now(),x="error");const k=o.fetchStatus==="fetching",P=x==="pending",Q=x==="error",z=P&&k,W=c!==void 0,m={status:x,fetchStatus:o.fetchStatus,isPending:P,isSuccess:x==="success",isError:Q,isInitialLoading:z,isLoading:z,data:c,dataUpdatedAt:o.dataUpdatedAt,error:C,errorUpdatedAt:H,failureCount:o.fetchFailureCount,failureReason:o.fetchFailureReason,errorUpdateCount:o.errorUpdateCount,isFetched:o.dataUpdateCount>0||o.errorUpdateCount>0,isFetchedAfterMount:o.dataUpdateCount>g.dataUpdateCount||o.errorUpdateCount>g.errorUpdateCount,isFetching:k,isRefetching:k&&!P,isLoadingError:Q&&!W,isPaused:o.fetchStatus==="paused",isPlaceholderData:y,isRefetchError:Q&&W,isStale:L(e,t),refetch:this.refetch,promise:this.#r,isEnabled:p(t.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const f=m.data!==void 0,v=m.status==="error"&&!f,S=w=>{v?w.reject(m.error):f&&w.resolve(m.data)},K=()=>{const w=this.#r=m.promise=V();S(w)},j=this.#r;switch(j.status){case"pending":e.queryHash===s.queryHash&&S(j);break;case"fulfilled":(v||m.data!==j.value)&&K();break;case"rejected":(!v||m.error!==j.reason)&&K();break}}return m}updateResult(){const e=this.#t,t=this.createResult(this.#e,this.options);if(this.#n=this.#e.state,this.#l=this.options,this.#n.data!==void 0&&(this.#d=this.#e),U(t,e))return;this.#t=t;const s=()=>{if(!e)return!0;const{notifyOnChangeProps:r}=this.options,a=typeof r=="function"?r():r;if(a==="all"||!a&&!this.#f.size)return!0;const d=new Set(a??this.#f);return this.options.throwOnError&&d.add("error"),Object.keys(this.#t).some(n=>{const h=n;return this.#t[h]!==e[h]&&d.has(h)})};this.#S({listeners:s()})}#C(){const e=this.#s.getQueryCache().build(this.#s,this.options);if(e===this.#e)return;const t=this.#e;this.#e=e,this.#p=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#v()}#S(e){Y.batch(()=>{e.listeners&&this.listeners.forEach(t=>{t(this.#t)}),this.#s.getQueryCache().notify({query:this.#e,type:"observerResultsUpdated"})})}};function le(e,t){return p(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function J(e,t){return le(e,t)||e.state.data!==void 0&&F(e,t,t.refetchOnMount)}function F(e,t,s){if(p(t.enabled,e)!==!1&&b(t.staleTime,e)!=="static"){const r=typeof s=="function"?s(e):s;return r==="always"||r!==!1&&L(e,t)}return!1}function q(e,t,s,r){return(e!==t||p(r.enabled,e)===!1)&&(!s.suspense||e.state.status!=="error")&&L(e,s)}function L(e,t){return p(t.enabled,e)!==!1&&e.isStaleByTime(b(t.staleTime,e))}function ue(e,t){return!U(e.getCurrentResult(),t)}var te=u.createContext(!1),de=()=>u.useContext(te);te.Provider;function fe(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var pe=u.createContext(fe()),me=()=>u.useContext(pe),xe=(e,t,s)=>{const r=s?.state.error&&typeof e.throwOnError=="function"?Z(e.throwOnError,[s.state.error,s]):e.throwOnError;(e.suspense||e.experimental_prefetchInRender||r)&&(t.isReset()||(e.retryOnMount=!1))},ge=e=>{u.useEffect(()=>{e.clearReset()},[e])},ye=({result:e,errorResetBoundary:t,throwOnError:s,query:r,suspense:a})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(a&&e.data===void 0||Z(s,[e.error,r])),ve=e=>{if(e.suspense){const s=a=>a==="static"?a:Math.max(a??1e3,1e3),r=e.staleTime;e.staleTime=typeof r=="function"?(...a)=>s(r(...a)):s(r),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},be=(e,t)=>e.isLoading&&e.isFetching&&!t,Re=(e,t)=>e?.suspense&&t.isPending,X=(e,t,s)=>t.fetchOptimistic(e).catch(()=>{s.clearReset()});function Ce(e,t,s){const r=de(),a=me(),d=ne(),n=d.defaultQueryOptions(e);d.getDefaultOptions().queries?._experimental_beforeQuery?.(n);const h=d.getQueryCache().get(n.queryHash);n._optimisticResults=r?"isRestoring":"optimistic",ve(n),xe(n,a,h),ge(a);const g=!d.getQueryCache().get(n.queryHash),[l]=u.useState(()=>new t(d,n)),o=l.getOptimisticResult(n),y=!r&&e.subscribed!==!1;if(u.useSyncExternalStore(u.useCallback(c=>{const C=y?l.subscribe(Y.batchCalls(c)):D;return l.updateResult(),C},[l,y]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),u.useEffect(()=>{l.setOptions(n)},[n,l]),Re(n,o))throw X(n,l,a);if(ye({result:o,errorResetBoundary:a,throwOnError:n.throwOnError,query:h,suspense:n.suspense}))throw o.error;return d.getDefaultOptions().queries?._experimental_afterQuery?.(n,o),n.experimental_prefetchInRender&&!A&&be(o,r)&&(g?X(n,l,a):h?.promise)?.catch(D).finally(()=>{l.updateResult()}),n.notifyOnChangeProps?o:l.trackResult(o)}function Se(e,t){return Ce(e,he)}const je=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],we=M("activity",je);const Ne=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],Oe=M("arrow-up-right",Ne);const Ee=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Te=M("circle-check",Ee);const Ie=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],_e=M("plus",Ie),O=u.forwardRef(({className:e,children:t,...s},r)=>i.jsx("div",{ref:r,className:R("rounded-3xl border border-border bg-card p-6 shadow-sm",e),...s,children:t}));O.displayName="Card";const E=u.forwardRef(({className:e,children:t,...s},r)=>i.jsx("div",{ref:r,className:R("flex flex-col gap-1",e),...s,children:t}));E.displayName="CardHeader";const T=u.forwardRef(({className:e,children:t,...s},r)=>i.jsx("h3",{ref:r,className:R("text-lg font-semibold",e),...s,children:t}));T.displayName="CardTitle";const I=u.forwardRef(({className:e,children:t,...s},r)=>i.jsx("p",{ref:r,className:R("text-sm text-muted-foreground",e),...s,children:t}));I.displayName="CardDescription";const _=u.forwardRef(({className:e,children:t,...s},r)=>i.jsx("div",{ref:r,className:R("mt-4 flex flex-col gap-4",e),...s,children:t}));_.displayName="CardContent";function Me(e){return ee("/action",{method:"POST",body:JSON.stringify(e),auth:!0})}function ke(){return ce({mutationFn:Me})}function Pe(){return ee("/health",{method:"GET"})}function Qe(){return Se({queryKey:["health"],queryFn:Pe,staleTime:6e4,retry:1})}function Ue(){const{data:e,isLoading:t}=Qe(),{mutateAsync:s,isPending:r}=ke(),[a,d]=u.useState(null),n=async()=>{try{const h=await s({type:"RUN_WORKFLOW",payload:{source:"dashboard"}});d(h.data.id)}catch{}};return i.jsxs("div",{className:"space-y-8",children:[i.jsxs("section",{className:"grid gap-4 lg:grid-cols-[2fr,1fr]",children:[i.jsxs(O,{className:"border-none bg-gradient-to-br from-slate-900 via-slate-900 to-emerald-900 text-white",children:[i.jsxs(E,{children:[i.jsx(T,{className:"text-2xl",children:"Action control center"}),i.jsx(I,{className:"text-white/70",children:"Keep automation runs healthy and ready for launch."})]}),i.jsxs(_,{children:[i.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-white/60",children:"Service status"}),i.jsx("p",{className:"mt-2 text-lg font-semibold",children:t?"Checking…":e?.data.status??"Unknown"})]}),i.jsxs(oe,{variant:"secondary",className:"gap-2",onClick:n,disabled:r,children:[i.jsx(_e,{className:"h-4 w-4"}),r?"Triggering…":"Trigger action"]})]}),a?i.jsxs("div",{className:"mt-4 text-xs text-emerald-200",children:["Last action created: ",a]}):null]})]}),i.jsxs(O,{children:[i.jsxs(E,{children:[i.jsx(T,{className:"text-xl",children:"Today’s pulse"}),i.jsx(I,{children:"Realtime signals from the API stack."})]}),i.jsx(_,{children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between rounded-2xl bg-slate-100 px-4 py-3",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.jsx(Te,{className:"h-4 w-4 text-emerald-500"}),"Auth gateway"]}),i.jsx("span",{className:"text-xs text-emerald-600",children:"Stable"})]}),i.jsxs("div",{className:"flex items-center justify-between rounded-2xl bg-slate-100 px-4 py-3",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.jsx(we,{className:"h-4 w-4 text-sky-500"}),"Action runner"]}),i.jsx("span",{className:"text-xs text-sky-600",children:"Nominal"})]}),i.jsxs("button",{className:"flex items-center gap-2 text-sm font-medium text-emerald-700",children:["View full report",i.jsx(Oe,{className:"h-4 w-4"})]})]})})]})]}),i.jsx("section",{className:"grid gap-4 md:grid-cols-3",children:[{title:"Automation coverage",value:"84%",note:"Up 12% this week"},{title:"Average response time",value:"220ms",note:"Healthy threshold"},{title:"Pending tasks",value:"14",note:"3 require approval"}].map(h=>i.jsxs(O,{children:[i.jsxs(E,{children:[i.jsx(I,{children:h.title}),i.jsx(T,{className:"text-3xl",children:h.value})]}),i.jsx(_,{children:i.jsx("p",{className:"text-xs text-muted-foreground",children:h.note})})]},h.title))})]})}function Le(){return i.jsx(Ue,{})}export{Le as default};
